
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nonlinear Systems of Equations &#8212; ENGR 1330 Course Notes</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/p4e.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ENGR 1330 Course Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to ENGR 1330
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson00/lesson00.html">
   0: Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson01/lesson01.html">
   1: Data Science and Problem Solving:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson02/lesson02.html">
   2: Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson03/lesson03.html">
   3: Data Types and Typecasting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson04/lesson04.html">
   4: User Interaction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson041/lesson04.1.html">
   4.1: Data Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson05/lesson05.html">
   5: Algorithm Building Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson06/lesson06.html">
   6: Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson07/lesson07.html">
   7: Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson08/lesson08.html">
   8: Vectors and Matrices (as lists)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson09/lesson09.html">
   9: Matrix Manipulation(s) using
   <em>
    NumPy
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="lesson10.html">
   10: Vector/Matrix applications (Under Construction)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson11/lesson11.html">
   11: Databases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson12/lesson12.html">
   12: Databases and PANDAS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson13/lesson13.html">
   13: Applications of PANDAS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson14/lesson14.html">
   14: Visual display of data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson15.html">
   Lesson 15: Working with files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson16.html">
   Lesson 16: File Manipulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson17.html">
   Lesson 17: Matrix manipulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson18.html">
   Lesson 18: Arrays in numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson19.html">
   Lesson 19: Database concepts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson20.html">
   Lesson 20: Database processing (
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson21/lesson21.html">
   21: Testing Hypothesis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson22.html">
   Lesson 22: Plotting (
   <code class="docutils literal notranslate">
    <span class="pre">
     matplotlib
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson23.html">
   Lesson 23: Data models and visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson32/lesson32.html">
   32: K Nearest Neighbor (KNN) Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson33/lesson33.html">
   33: KNN Classification (Continued)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson34/lesson34.html">
   34: KNN Applications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson35.html">
   Lesson 35: Logistic Regression (Homebrew)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson36.html">
   Lesson 36: Logistic Regression (
   <code class="docutils literal notranslate">
    <span class="pre">
     sklearn
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson37.html">
   Lesson 37: Nearest Neighbor Classification (Homebrew)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson38.html">
   38: K-Nearest Neighbor Classification (sklearn)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../video_log/video_log.html">
   Video Archive
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/lessons/lesson10/NonLinearSystems.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Flessons/lesson10/NonLinearSystems.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/lessons/lesson10/NonLinearSystems.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-variable-extension-of-newtons-method">
   Multiple-variable extension of Newton’s Method
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-using-analytical-derivatives">
   Example using Analytical Derivatives
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quasi-newton-method-using-finite-difference-approximations-for-the-derivative">
   Quasi-Newton Method using Finite Difference Approximations for the Derivative
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="nonlinear-systems-of-equations">
<h1>Nonlinear Systems of Equations<a class="headerlink" href="#nonlinear-systems-of-equations" title="Permalink to this headline">¶</a></h1>
<p>Non-linear systems are extensions of the linear systems cases except the systems involve products and powers of the unknown variables. Non-linear problems are often quite difficult to manage, especially when the systems are large (many rows and many variables).
The solution to non-linear systems, if non-trivial or even possible, are usually iterative. Within the iterative steps is a linearization component – these linear systems which are intermediate computations within the overall solution process are treated by an appropriate linear system method (direct or iterative).
Consider the system below:</p>
<p>\begin{gather}
\begin{matrix}
x^2 &amp; +~y^2  \
e^x &amp; +~y  \
\end{matrix}
\begin{matrix}
= 4\
= 1\
\end{matrix}
\end{gather}</p>
<p>Suppose we have a solution guess <span class="math notranslate nohighlight">\(x_{k},y_{k}\)</span>, which of course could be wrong, but we could linearize about that guess as</p>
<p>\begin{gather}
\mathbf{A} =
\begin{pmatrix}
x_k &amp; + ~y_k  \
0 &amp; + ~1  \
\end{pmatrix}
~\mathbf{x} =
\begin{pmatrix}
x_{k+1} \
y_{k+1} \
\end{pmatrix}
~ \mathbf{b} =
\begin{pmatrix}
4\
1 - e^{x_k}\
\end{pmatrix}
\end{gather}</p>
<p>Now if we assemble the system in the usual fashion, <span class="math notranslate nohighlight">\(\mathbf{A} \cdot \mathbf{x_{k+1}} = ~ \mathbf{b}~\)</span> we have a system of linear equations\footnote{Linear in <span class="math notranslate nohighlight">\(\mathbf{x_{k+1}}\)</span>}, which expanded look like:</p>
<p>\begin{gather}
\begin{pmatrix}
x_k &amp; + ~y_k  \
0 &amp; + ~1  \
\end{pmatrix}
\cdot
\begin{pmatrix}
x_{k+1} \
y_{k+1} \
\end{pmatrix}
~ =
\begin{pmatrix}
4\
1 - e^{x_k}\
\end{pmatrix}
\end{gather}</p>
<p>Now that the system is linear, and we can solve for <span class="math notranslate nohighlight">\(\mathbf{x_{k+1}}\)</span> using our linear system solver for the new guess.
If the system is convergent (not all are) then if we update, and repeat  we will eventually find a result.</p>
<p>What one really needs is a way to construct the linear system that has a systematic update method, that is discussed below</p>
<div class="section" id="multiple-variable-extension-of-newtons-method">
<h2>Multiple-variable extension of Newton’s Method<a class="headerlink" href="#multiple-variable-extension-of-newtons-method" title="Permalink to this headline">¶</a></h2>
<p>This section presents the Newton-Raphson method as a way to sometimes solve systems of non-linear equations.</p>
<p>Consider an example where the function \textbf{f} is a vector-valued function of a vector argument.</p>
<p>\begin{gather}
\mathbf{f(x)} =
\begin{matrix}
f_1 = &amp; x^2 &amp; +~y^2 &amp; - 4\
f_2 = &amp; e^x &amp; +~y  &amp; - 1\
\end{matrix}
\end{gather}</p>
<p>Let’s also recall Newtons method for scalar valued function of a single variable.</p>
<p>\begin{equation}
x_{k+1}=x_{k} - \frac{  f(x_{k})  }{   \frac{df}{dx}\rvert_{x_k} }
\label{eqn:NewtonFormula}
\end{equation}</p>
<p>When extending to higher dimensions, the analog for <span class="math notranslate nohighlight">\(x\)</span> is the vector \textbf{x} and the analog for the function <span class="math notranslate nohighlight">\(f()\)</span> is the vector function \textbf{f()}.
What remains is an analog for the first derivative in the denominator (and the concept of division of a matrix).</p>
<p>The analog to the first derivative is a matrix called the Jacobian which is comprised of the first derivatives of the function \textbf{f} with respect to the arguments \textbf{x}.<br />
For example for a 2-value function of 2 arguments (as our example above)</p>
<p>\begin{equation}
\frac{df}{dx}\rvert_{x_k} =&gt;
\begin{pmatrix}
\frac{\partial f_1}{\partial x_1} &amp; \frac{\partial f_1}{\partial x_2} \
~ &amp; ~ \
\frac{\partial f_2}{\partial x_1} &amp; \frac{\partial f_2}{\partial x_2} \
\end{pmatrix}
\label{eqn:Jacobian}
\end{equation}</p>
<p>Next recall that division is replaced by matrix multiplication with the multiplicative inverse, so the analogy continues as</p>
<p>\begin{equation}
\frac{1}{\frac{df}{dx}\rvert_{x_k}} =&gt;
{\begin{pmatrix}
\frac{\partial f_1}{\partial x_1} &amp; \frac{\partial f_1}{\partial x_2} \
~ &amp; ~ \
\frac{\partial f_2}{\partial x_1} &amp; \frac{\partial f_2}{\partial x_2} \
\end{pmatrix}}^{-1}
\label{eqn:JacobianInverse}
\end{equation}</p>
<p>Let’s name the Jacobian \textbf{J(x)}.</p>
<p>So the multi-variate Newton’s method can be written as</p>
<p>\begin{equation}
\mathbf{x}<em>{k+1}=\mathbf{x}</em>{k} - \mathbf{J(x)}^{-1}\rvert_{x_k} \cdot \mathbf{f(x)}\rvert_{x_k}
\label{eqn:VectorNewtonFormula}
\end{equation}</p>
<p>In the linear systems lessons we did find a way to solve for an inverse, but it’s not necessary, and is computationally expensive to invert in these examples – a series of rearrangement of the system above yields a nice scheme that does not require inversion of a matrix.</p>
<p>First, move the <span class="math notranslate nohighlight">\(\mathbf{x}_{k}\)</span> to the left-hand side.</p>
<p>\begin{equation}
\mathbf{x}<em>{k+1}-\mathbf{x}</em>{k} = - \mathbf{J(x)}^{-1}\rvert_{x_k} \cdot \mathbf{f(x)}\rvert_{x_k}
\end{equation}</p>
<p>Next multiply both sides by the Jacobian (The Jacobian must be non-singular otherwise we are dividing by zero)</p>
<p>\begin{equation}
\mathbf{J(x)}\rvert_{x_k} \cdot (\mathbf{x}<em>{k+1}-\mathbf{x}</em>{k}) = - \mathbf{J(x)}\rvert_{x_k} \cdot \mathbf{J(x)}^{-1}\rvert_{x_k} \cdot \mathbf{f(x)}\rvert_{x_k}
\end{equation}</p>
<p>Recall a matrix multiplied by its inverse returns the identity matrix (the matrix equivalent of unity)</p>
<p>\begin{equation}
-\mathbf{J(x)}\rvert_{x_k} \cdot (\mathbf{x}<em>{k+1}-\mathbf{x}</em>{k}) = \mathbf{f(x)}\rvert_{x_k}
\end{equation}</p>
<p>So we now have an algorithm:</p>
<ol class="simple">
<li><p>Start with an initial guess <span class="math notranslate nohighlight">\(\mathbf{x}_{k}\)</span>, compute <span class="math notranslate nohighlight">\(\mathbf{f(x)}\rvert_{x_k}\)</span>, and <span class="math notranslate nohighlight">\(\mathbf{J(x)}\rvert_{x_k}\)</span>.</p></li>
<li><p>Test for stopping.  Is <span class="math notranslate nohighlight">\(\mathbf{f(x)}\rvert_{x_k}\)</span> close to zero?  If yes, exit and report results, otherwise continue.</p></li>
<li><p>Solve the linear system <span class="math notranslate nohighlight">\(\mathbf{J(x)}\rvert_{x_k} \cdot (\mathbf{x}_{k+1}-\mathbf{x}_{k}) = \mathbf{f(x)}\rvert_{x_k}\)</span>.</p></li>
<li><p>Test for stopping.  Is <span class="math notranslate nohighlight">\( (\mathbf{x}_{k+1}-\mathbf{x}_{k})\)</span> close to zero?  If yes, exit and report results, otherwise continue.</p></li>
<li><p>Compute the update <span class="math notranslate nohighlight">\(\mathbf{x}_{k+1} = \mathbf{x}_{k} - (\mathbf{x}_{k+1}-\mathbf{x}_{k}) \)</span>, then</p></li>
<li><p>Move the update into the guess vector <span class="math notranslate nohighlight">\(\mathbf{x}_{k} &lt;=\mathbf{x}_{k+1}\)</span> =and repeat step 1. Stop after too many steps.</p></li>
</ol>
</div>
<div class="section" id="example-using-analytical-derivatives">
<h2>Example using Analytical Derivatives<a class="headerlink" href="#example-using-analytical-derivatives" title="Permalink to this headline">¶</a></h2>
<p>Now to complete the example we will employ this algorithm.</p>
<p>The function (repeated)</p>
<p>\begin{gather}
\mathbf{f(x)} =
\begin{matrix}
f_1 = &amp; x^2 &amp; +~y^2 &amp; - 4\
f_2 = &amp; e^x &amp; +~y  &amp; - 1\
\end{matrix}
\end{gather}</p>
<p>Then the Jacobian, here we will compute it analytically because we can</p>
<p>\begin{equation}
\mathbf{J(x)}=&gt;
{\begin{pmatrix}
2x &amp; 2y \
~ &amp; ~ \
e^x &amp; 1 \
\end{pmatrix}}
\end{equation}</p>
<p>Now for the scripts.</p>
<p>We will start by defining the two equations, and their derivatives, as well a a vector valued function <code class="docutils literal notranslate"><span class="pre">func</span></code> and its Jacobian <code class="docutils literal notranslate"><span class="pre">jacob</span></code> as below.  Here the two modules <code class="docutils literal notranslate"><span class="pre">LinearSolverPivot</span></code> and <code class="docutils literal notranslate"><span class="pre">vector_matrix_lib</span></code> are just python source code files containing prototype functions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#################################################################</span>
<span class="c1"># Newton Solver Example -- Analytical Derivatives               #</span>
<span class="c1">#################################################################</span>
<span class="kn">import</span> <span class="nn">math</span>   <span class="c1"># This will import math module from python distribution</span>
<span class="kn">from</span> <span class="nn">LinearSolverPivot</span> <span class="kn">import</span> <span class="n">linearsolver</span> <span class="c1"># This will import our solver module</span>
<span class="kn">from</span> <span class="nn">vector_matrix_lib</span> <span class="kn">import</span> <span class="n">writeM</span><span class="p">,</span><span class="n">writeV</span><span class="p">,</span><span class="n">vdotv</span><span class="p">,</span><span class="n">vvsub</span> <span class="c1"># This will import our vector functions</span>

<span class="k">def</span> <span class="nf">eq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">eq1</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">4.0</span>
    <span class="k">return</span><span class="p">(</span><span class="n">eq1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">eq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">eq2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="mf">1.0</span>
    <span class="k">return</span><span class="p">(</span><span class="n">eq2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ddxeq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">ddxeq1</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">x</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ddxeq1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ddyeq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">ddyeq1</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">y</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ddyeq1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ddxeq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">ddxeq2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ddxeq2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ddyeq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">ddyeq2</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ddyeq2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">func</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># null list</span>
    <span class="c1"># build the function</span>
    <span class="n">func</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">eq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">func</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">eq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">jacob</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">jacob</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># constructed list  </span>
    <span class="c1">#build the  jacobian</span>
    <span class="n">jacob</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">ddxeq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">jacob</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">ddyeq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">jacob</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">ddxeq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">jacob</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">ddyeq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">jacob</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next we create vectors to store values, and supply initial guesses to the system, and echo the inputs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">deltax</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># null list</span>
<span class="n">xguess</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># null list</span>
<span class="n">myfunc</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># null list</span>
<span class="n">myjacob</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># constructed list  </span>
<span class="c1"># supply initial guess</span>
<span class="n">xguess</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Value for x : &quot;</span><span class="p">))</span>
<span class="n">xguess</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Value for y : &quot;</span><span class="p">))</span>
<span class="c1"># build the initial function</span>
<span class="n">myfunc</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">xguess</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xguess</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1">#build the initial jacobian</span>
<span class="n">myjacob</span><span class="o">=</span><span class="n">jacob</span><span class="p">(</span><span class="n">xguess</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xguess</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1">#write initial results</span>
<span class="n">writeV</span><span class="p">(</span><span class="n">xguess</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Initial X vector &quot;</span><span class="p">)</span>
<span class="n">writeV</span><span class="p">(</span><span class="n">myfunc</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Initial FUNC vector &quot;</span><span class="p">)</span>
<span class="n">writeM</span><span class="p">(</span><span class="n">myjacob</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Initial Jacobian &quot;</span><span class="p">)</span>
<span class="c1"># solver parameters</span>
<span class="n">tolerancef</span> <span class="o">=</span> <span class="mf">1.0e-9</span>
<span class="n">tolerancex</span> <span class="o">=</span> <span class="mf">1.0e-9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">StdinNotImplementedError</span><span class="g g-Whitespace">                  </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="n">cae27ce65719</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">myjacob</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># constructed list</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="c1"># supply initial guess</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="n">xguess</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Value for x : &quot;</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">xguess</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Value for y : &quot;</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="c1"># build the initial function</span>

<span class="nn">/opt/jupyterhub/lib/python3.8/site-packages/ipykernel/kernelbase.py</span> in <span class="ni">raw_input</span><span class="nt">(self, prompt)</span>
<span class="g g-Whitespace">    </span><span class="mi">855</span>         <span class="s2">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">856</span><span class="s2">         if not self._allow_stdin:</span>
<span class="ne">--&gt; </span><span class="mi">857</span><span class="s2">             raise StdinNotImplementedError(</span>
<span class="g g-Whitespace">    </span><span class="mi">858</span><span class="s2">                 &quot;raw_input was called, but this frontend does not support input requests.&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">859</span><span class="s2">             )</span>

<span class="ne">StdinNotImplementedError</span>: raw_input was called, but this frontend does not support input requests.
</pre></div>
</div>
</div>
</div>
<p>Now we apply the algorithm a few times, here the count is set to 10. So eneter the loop, test for stopping, then update.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Newton-Raphson</span>
<span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">myfunc</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">xguess</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xguess</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">testf</span> <span class="o">=</span> <span class="n">vdotv</span><span class="p">(</span><span class="n">myfunc</span><span class="p">,</span><span class="n">myfunc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">testf</span> <span class="o">&lt;=</span> <span class="n">tolerancef</span> <span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f(x) close to zero</span><span class="se">\n</span><span class="s2"> test value : &quot;</span><span class="p">,</span> <span class="n">testf</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="n">myjacob</span><span class="o">=</span><span class="n">jacob</span><span class="p">(</span><span class="n">xguess</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xguess</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">deltax</span><span class="o">=</span><span class="n">linearsolver</span><span class="p">(</span><span class="n">myjacob</span><span class="p">,</span><span class="n">myfunc</span><span class="p">)</span>
    <span class="n">testx</span> <span class="o">=</span> <span class="n">vdotv</span><span class="p">(</span><span class="n">deltax</span><span class="p">,</span><span class="n">deltax</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">testx</span> <span class="o">&lt;=</span> <span class="n">tolerancex</span> <span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;solution change small</span><span class="se">\n</span><span class="s2"> test value : &quot;</span><span class="p">,</span> <span class="n">testx</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="n">xguess</span><span class="o">=</span><span class="n">vvsub</span><span class="p">(</span><span class="n">xguess</span><span class="p">,</span><span class="n">deltax</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">##    print(&quot;iteration : &quot;,iteration)</span>
<span class="c1">##    writeV(xguess,2,&quot;Current X vector &quot;)</span>
<span class="c1">##    writeV(myfunc,2,&quot;Current FUNC vector &quot;)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exiting Iteration : &quot;</span><span class="p">,</span><span class="n">iteration</span><span class="p">)</span>
<span class="n">writeV</span><span class="p">(</span><span class="n">xguess</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Exiting X vector &quot;</span><span class="p">)</span>
<span class="n">writeV</span><span class="p">(</span><span class="n">myfunc</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Exiting FUNC vector &quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>f(x) close to zero
 test value :  4.741631714784361e-10
Exiting Iteration :  6
------ Exiting X vector  ------
-1.8162690125838175
0.8373700502918618
-----------------------------
------ Exiting FUNC vector  ------
2.1727197990095704e-05
1.446388252723807e-06
-----------------------------
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="quasi-newton-method-using-finite-difference-approximations-for-the-derivative">
<h2>Quasi-Newton Method using Finite Difference Approximations for the Derivative<a class="headerlink" href="#quasi-newton-method-using-finite-difference-approximations-for-the-derivative" title="Permalink to this headline">¶</a></h2>
<p>The next variant is to approximate the derivatives – usually a Finite-Difference approximation is used, either forward, backward, or centered differences – generally determined based on the actual behavior of the functions themselves or by trial and error.</p>
<p>For really huge systems, we usually make the program itself make the adaptions as it proceeds.</p>
<p>The coding for a finite-difference representation of a Jacobian is shown in Listing that follows
In constructing the Jacobian, we observe that each column of the Jacobian is simply the directional derivative of the function with respect to the variable associated with the column.<br />
For instance, the first column of the Jacobian in the example is first derivative of the first function (all rows) with respect to the first variable, in this case <span class="math notranslate nohighlight">\(x\)</span>.  The second column is the first derivative of the second function with respect to the second variable, <span class="math notranslate nohighlight">\(y\)</span>.<br />
This structure is useful to generalize the Jacobian construction method because we could write (yet another) prototype function that can take the directional derivatives for us, and just insert the returns as columns; in the example we simply modified the <code class="docutils literal notranslate"><span class="pre">ddx</span></code> and <code class="docutils literal notranslate"><span class="pre">ddy</span></code> functions from analytical to simple finite differences.</p>
<p>The example listing is specific to the 2X2 function in the example, but the extension to more general cases is evident.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#################################################################</span>
<span class="c1"># Newton Solver Example -- Numerical Derivatives               #</span>
<span class="c1">#################################################################</span>
<span class="kn">import</span> <span class="nn">math</span>   <span class="c1"># This will import math module from python distribution</span>
<span class="kn">from</span> <span class="nn">LinearSolverPivot</span> <span class="kn">import</span> <span class="n">linearsolver</span> <span class="c1"># This will import our solver module</span>
<span class="kn">from</span> <span class="nn">vector_matrix_lib</span> <span class="kn">import</span> <span class="n">writeM</span><span class="p">,</span><span class="n">writeV</span><span class="p">,</span><span class="n">vdotv</span><span class="p">,</span><span class="n">vvsub</span> <span class="c1"># This will import our vector functions</span>

<span class="k">def</span> <span class="nf">eq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">eq1</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mf">4.0</span>
    <span class="k">return</span><span class="p">(</span><span class="n">eq1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">eq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">eq2</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">y</span> <span class="o">-</span> <span class="mf">1.0</span>
    <span class="k">return</span><span class="p">(</span><span class="n">eq2</span><span class="p">)</span>
<span class="c1">##############################################################</span>
<span class="c1"># This portion is changed for finite-difference method to evaluate derivatives #</span>
<span class="c1">##############################################################</span>
<span class="k">def</span> <span class="nf">ddxeq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="mf">1.0e-6</span>
    <span class="n">ddxeq1</span> <span class="o">=</span> <span class="p">(</span><span class="n">eq1</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">delta</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">eq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span><span class="o">/</span><span class="n">delta</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ddxeq1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ddyeq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="mf">1.0e-6</span>
    <span class="n">ddyeq1</span> <span class="o">=</span> <span class="p">(</span><span class="n">eq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">delta</span><span class="p">)</span><span class="o">-</span><span class="n">eq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span><span class="o">/</span><span class="n">delta</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ddyeq1</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ddxeq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="mf">1.0e-6</span>
    <span class="n">ddxeq2</span> <span class="o">=</span> <span class="p">(</span><span class="n">eq2</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">delta</span><span class="p">,</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">eq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span><span class="o">/</span><span class="n">delta</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ddxeq2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ddyeq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="mf">1.0e-6</span>
    <span class="n">ddyeq2</span> <span class="o">=</span> <span class="p">(</span><span class="n">eq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">+</span><span class="n">delta</span><span class="p">)</span><span class="o">-</span><span class="n">eq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">))</span><span class="o">/</span><span class="n">delta</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ddyeq2</span><span class="p">)</span>
<span class="c1">##############################################################</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">func</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># null list</span>
    <span class="c1"># build the function</span>
    <span class="n">func</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">eq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">func</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">eq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">jacob</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">jacob</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># constructed list  </span>
    <span class="c1">#build the  jacobian</span>
    <span class="n">jacob</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">ddxeq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">jacob</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">ddyeq1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">jacob</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">ddxeq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">jacob</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">ddyeq2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">jacob</span><span class="p">)</span>
<span class="n">deltax</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># null list</span>
<span class="n">xguess</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># null list</span>
<span class="n">myfunc</span>  <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># null list</span>
<span class="n">myjacob</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.0</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span> <span class="c1"># constructed list  </span>
<span class="c1"># supply initial guess</span>
<span class="n">xguess</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Value for x : &quot;</span><span class="p">))</span>
<span class="n">xguess</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Value for y : &quot;</span><span class="p">))</span>
<span class="c1"># build the initial function</span>
<span class="n">myfunc</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">xguess</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xguess</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1">#build the initial jacobian</span>
<span class="n">myjacob</span><span class="o">=</span><span class="n">jacob</span><span class="p">(</span><span class="n">xguess</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xguess</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1">#write initial results</span>
<span class="n">writeV</span><span class="p">(</span><span class="n">xguess</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Initial X vector &quot;</span><span class="p">)</span>
<span class="n">writeV</span><span class="p">(</span><span class="n">myfunc</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Initial FUNC vector &quot;</span><span class="p">)</span>
<span class="n">writeM</span><span class="p">(</span><span class="n">myjacob</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Initial Jacobian &quot;</span><span class="p">)</span>
<span class="c1"># solver parameters</span>
<span class="n">tolerancef</span> <span class="o">=</span> <span class="mf">1.0e-9</span>
<span class="n">tolerancex</span> <span class="o">=</span> <span class="mf">1.0e-9</span>
<span class="c1"># Newton-Raphson</span>
<span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">myfunc</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">xguess</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xguess</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">testf</span> <span class="o">=</span> <span class="n">vdotv</span><span class="p">(</span><span class="n">myfunc</span><span class="p">,</span><span class="n">myfunc</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">testf</span> <span class="o">&lt;=</span> <span class="n">tolerancef</span> <span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;f(x) close to zero</span><span class="se">\n</span><span class="s2"> test value : &quot;</span><span class="p">,</span> <span class="n">testf</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="n">myjacob</span><span class="o">=</span><span class="n">jacob</span><span class="p">(</span><span class="n">xguess</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">xguess</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">deltax</span><span class="o">=</span><span class="n">linearsolver</span><span class="p">(</span><span class="n">myjacob</span><span class="p">,</span><span class="n">myfunc</span><span class="p">)</span>
    <span class="n">testx</span> <span class="o">=</span> <span class="n">vdotv</span><span class="p">(</span><span class="n">deltax</span><span class="p">,</span><span class="n">deltax</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">testx</span> <span class="o">&lt;=</span> <span class="n">tolerancex</span> <span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;solution change small</span><span class="se">\n</span><span class="s2"> test value : &quot;</span><span class="p">,</span> <span class="n">testx</span><span class="p">)</span>
        <span class="k">break</span>
    <span class="n">xguess</span><span class="o">=</span><span class="n">vvsub</span><span class="p">(</span><span class="n">xguess</span><span class="p">,</span><span class="n">deltax</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="c1">##    print(&quot;iteration : &quot;,iteration)</span>
<span class="c1">##    writeV(xguess,2,&quot;Current X vector &quot;)</span>
<span class="c1">##    writeV(myfunc,2,&quot;Current FUNC vector &quot;)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exiting Iteration : &quot;</span><span class="p">,</span><span class="n">iteration</span><span class="p">)</span>
<span class="n">writeV</span><span class="p">(</span><span class="n">xguess</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Exiting X vector &quot;</span><span class="p">)</span>
<span class="n">writeV</span><span class="p">(</span><span class="n">myfunc</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Exiting FUNC vector using Finite-Differences&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Value for x :  0
Value for y :  2
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>------ Initial X vector  ------
0.0
2.0
-----------------------------
------ Initial FUNC vector  ------
0.0
2.0
-----------------------------
------ Initial Jacobian  ------
[1.000088900582341e-06, 4.0000010006480125]
[1.0000005001842283, 1.000000000139778]
-----------------------------
f(x) close to zero
 test value :  1.124762923231742e-16
Exiting Iteration :  5
------ Exiting X vector  ------
-1.816264071231508
0.8373678009903361
-----------------------------
------ Exiting FUNC vector using Finite-Differences ------
1.0581842957435583e-08
7.077372021768724e-10
-----------------------------
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>()
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<p>Write a script that forward defines the multi-variate functions and implements the Newton-Raphson technique.
Implement the method, using analytical derivatives, and find a solution to:
\begin{gather}
\begin{matrix}
x^3 &amp; +~3y^2 &amp; = 21\
x^2&amp; +~2y  &amp; = -2 \
\end{matrix}
\end{gather}</p>
<p>Repeat the exercise, except use finite-differences to approximate the derivatives.</p>
<p>Write a script that forward defines the multi-variate functions and implements the Newton-Raphson technique.
Implement the method, using analytical derivatives, and find a solution to:
\begin{gather}
\begin{matrix}
x^2 &amp; +~ y^2 &amp; +~z^2 &amp; =~ 9\
~ &amp; ~ &amp; xyz &amp; =~ 1\
x &amp; +~ y &amp; -z^2 &amp; =~ 0\
\end{matrix}
\end{gather}</p>
<p>Repeat the exercise, except use finite-differences to approximate the derivatives.</p>
<p>Write a script that forward defines the multi-variate functions and implements the Newton-Raphson technique.
Implement the method, using analytical derivatives, and find a solution to:
\begin{gather}
\begin{matrix}
xyz &amp; -~ x^2 &amp; +~y^2 &amp; =~ 1.34\
~ &amp; xy &amp;-~z^2 &amp; =~ 0.09\
e^x &amp; -~ e^y &amp; +z &amp; =~ 0.41\
\end{matrix}
\end{gather}</p>
<p>Repeat the exercise, except use finite-differences to approximate the derivatives.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lessons/lesson10"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Theodore G. Cleveland and Farhang Forghanparast<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>