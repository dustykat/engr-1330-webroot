
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>16: Exploratory Data Analysis &#8212; ENGR 1330 Course Notes</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lesson 17: Matrix manipulation" href="../lesson17.html" />
    <link rel="prev" title="15: The matplotlib package" href="../lesson15/lesson15.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/p4e.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">ENGR 1330 Course Notes</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Welcome to ENGR 1330
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson00/lesson00.html">
   0: Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson01/lesson01.html">
   1: Data Science and Problem Solving:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson02/lesson02.html">
   2: Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson03/lesson03.html">
   3: Data Types and Typecasting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson04/lesson04.html">
   4: User Interaction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson041/lesson04.1.html">
   4.1: Data Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson05/lesson05.html">
   5: Algorithm Building Blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson06/lesson06.html">
   6: Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson07/lesson07.html">
   7: Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson08/lesson08.html">
   8: Vectors and Matrices (as lists)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson071/lesson071.html">
   7.1: Files from the Web (
   <code class="docutils literal notranslate">
    <span class="pre">
     requests.get
    </span>
    <span class="pre">
     ...
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson09/lesson09.html">
   9: Matrix Manipulation(s) using
   <em>
    NumPy
   </em>
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson10/lesson10.html">
   10: Vector/Matrix applications (Under Construction)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson11/lesson11.html">
   11: Databases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson12/lesson12.html">
   12: Databases and PANDAS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson13/lesson13.html">
   13: Applications of PANDAS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson14/lesson14.html">
   14: Visual display of data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson15/lesson15.html">
   15: The
   <code class="docutils literal notranslate">
    <span class="pre">
     matplotlib
    </span>
   </code>
   package
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   16: Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson17.html">
   Lesson 17: Matrix manipulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson18.html">
   Lesson 18: Arrays in numpy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson19.html">
   Lesson 19: Database concepts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson20.html">
   Lesson 20: Database processing (
   <code class="docutils literal notranslate">
    <span class="pre">
     pandas
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson21/lesson21.html">
   21: Testing Hypothesis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson22.html">
   Lesson 22: Plotting (
   <code class="docutils literal notranslate">
    <span class="pre">
     matplotlib
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson23.html">
   Lesson 23: Data models and visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson32/lesson32.html">
   32: K Nearest Neighbor (KNN) Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson33/lesson33.html">
   33: KNN Classification (Continued)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson34/lesson34.html">
   34: KNN Applications
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson35.html">
   Lesson 35: Logistic Regression (Homebrew)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson36.html">
   Lesson 36: Logistic Regression (
   <code class="docutils literal notranslate">
    <span class="pre">
     sklearn
    </span>
   </code>
   )
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson37.html">
   Lesson 37: Nearest Neighbor Classification (Homebrew)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../lesson38.html">
   38: K-Nearest Neighbor Classification (sklearn)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../video_log/video_log.html">
   Video Archive
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/lessons/lesson16/lesson16.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Flessons/lesson16/lesson16.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/lessons/lesson16/lesson16.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-science-inferences-from-visual-display-of-data">
   Data Science Inferences from Visual Display of Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lagrangian-polynomial-data-model-for-interpolation">
     Lagrangian Polynomial Data Model (for Interpolation)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#lagrangian-interpolation">
     Lagrangian Interpolation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1">
     Example 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2">
     Example 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#laboratory-16">
   Laboratory 16
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-set-16">
   Exercise Set 16
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="alert alert-block alert-info">
    <b><h1>ENGR 1330 Computational Thinking with Data Science </h1></b> 
</div> 
<p>Copyright © 2021 Theodore G. Cleveland and Farhang Forghanparast</p>
<p>Last GitHub Commit Date:</p>
<div class="tex2jax_ignore mathjax_ignore section" id="exploratory-data-analysis">
<h1>16: Exploratory Data Analysis<a class="headerlink" href="#exploratory-data-analysis" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>Data models</p></li>
<li><p>Performance metrics</p></li>
<li><p>Interpolation vs extrapolation</p></li>
</ul>
<div class="section" id="data-science-inferences-from-visual-display-of-data">
<h2>Data Science Inferences from Visual Display of Data<a class="headerlink" href="#data-science-inferences-from-visual-display-of-data" title="Permalink to this headline">¶</a></h2>
<p>Recall our line chart tool, and the time-speed data</p>
<p>Consider the experimental data below</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p>Elapsed Time (s)</p></th>
<th class="text-align:right head"><p>Speed (m/s)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p>0</p></td>
<td class="text-align:right"><p>0</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>1.0</p></td>
<td class="text-align:right"><p>3</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>2.0</p></td>
<td class="text-align:right"><p>7</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>3.0</p></td>
<td class="text-align:right"><p>12</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>4.0</p></td>
<td class="text-align:right"><p>20</p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>5.0</p></td>
<td class="text-align:right"><p>30</p></td>
</tr>
<tr class="row-even"><td class="text-align:right"><p>6.0</p></td>
<td class="text-align:right"><p>45.6</p></td>
</tr>
</tbody>
</table>
<p>Show the relationship between time and speed.  What can we learn about the relationship? Is it linear, quadratic, cubic, hyperbolic?  How do we explore these questions?</p>
<hr class="docutils" />
<p>First lets define a plotting function that plots <strong>observations</strong> and <strong>data model</strong> values on same chart.  The convention in these notes is red markers are the data and blue curves are the model.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the context herein, the observations are the actual <strong>data</strong>; the model (a straight line, parabola, or some other functional relationship <span class="math notranslate nohighlight">\(y=f(x)\)</span>) is the data model.  We may stipulate the structure of the model such as <span class="math notranslate nohighlight">\(y=\text{slope}\cdot x + \text{intercept}\)</span>, or more conventionally <span class="math notranslate nohighlight">\(y=mx+b\)</span> and seek values of <strong>m</strong> and <strong>b</strong> that explain the observations.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="k">def</span> <span class="nf">make2plot</span><span class="p">(</span><span class="n">listx1</span><span class="p">,</span><span class="n">listy1</span><span class="p">,</span><span class="n">listx2</span><span class="p">,</span><span class="n">listy2</span><span class="p">,</span><span class="n">strlablx</span><span class="p">,</span><span class="n">strlably</span><span class="p">,</span><span class="n">strtitle</span><span class="p">):</span>
    <span class="n">mydata</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span> <span class="c1"># build a square drawing canvass from figure class</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">listx1</span><span class="p">,</span><span class="n">listy1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;v&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># basic data plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">listx2</span><span class="p">,</span><span class="n">listy2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># basic model plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">strlablx</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">strlably</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Observations&#39;</span><span class="p">,</span><span class="s1">&#39;Model&#39;</span><span class="p">])</span><span class="c1"># modify for argument insertion</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">strtitle</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span>
</pre></div>
</div>
</div>
</div>
<p>Test our function, we will plot the data as red markers and the model as blue lines; in this instance we will just reuse data so the plot will look perfect, but its only to test the plotting function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create two lists; time  and speed - these represent observations</span>
<span class="n">time</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">,</span><span class="mf">3.0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span><span class="mf">5.0</span><span class="p">,</span><span class="mf">6.0</span><span class="p">]</span>
<span class="n">speed</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mf">45.6</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>First just plot the data as red markers</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">make2plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">speed</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="s1">&#39;time (sec.)&#39;</span><span class="p">,</span><span class="s1">&#39;speed (m/s)&#39;</span><span class="p">,</span><span class="s1">&#39;Plot of observations&#39;</span><span class="p">)</span> <span class="c1"># the blue line is all at 0,0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson16_6_0.png" src="../../_images/lesson16_6_0.png" />
</div>
</div>
<p>Now plot the same data as a blue line</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">make2plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">time</span><span class="p">,</span><span class="n">speed</span><span class="p">,</span><span class="s1">&#39;time (sec.)&#39;</span><span class="p">,</span><span class="s1">&#39;speed (m/s)&#39;</span><span class="p">,</span><span class="s1">&#39;Plot of model only, ignore red marker&#39;</span><span class="p">)</span> <span class="c1"># the red markers all at 0,0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson16_8_0.png" src="../../_images/lesson16_8_0.png" />
</div>
</div>
<p>Now both on same graph (we are reusing the lists, so fit will appear perfect)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">make2plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">speed</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">speed</span><span class="p">,</span><span class="s1">&#39;time (sec.)&#39;</span><span class="p">,</span><span class="s1">&#39;speed (m/s)&#39;</span><span class="p">,</span><span class="s1">&#39;Plot of model&#39;</span><span class="p">)</span> <span class="c1"># the red markers all at 0,0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson16_10_0.png" src="../../_images/lesson16_10_0.png" />
</div>
</div>
<hr class="docutils" />
<p>Now we can consider a data model.  For this example, lets simply stipulate that the relationship may be up to a 3-rd order polynomial.</p>
<p><span class="math notranslate nohighlight">\(y = \beta_0 + \beta_1 \cdot x + \beta_2 \cdot x^2 + \beta_2 \cdot x^3\)</span></p>
<p>where <span class="math notranslate nohighlight">\(y\)</span> in this example is speed in meters/second, and <span class="math notranslate nohighlight">\(x\)</span> is time in seconds.  As a data model all we are doing is explaining the structure of the relationship, if we knew that it is a physical process we might adjust our model to be constant acceleration kinematics.  However for the example, the polynomial will suffice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a data model - lets use a polynomial model</span>
<span class="k">def</span> <span class="nf">polynomial</span><span class="p">(</span><span class="n">b0</span><span class="p">,</span><span class="n">b1</span><span class="p">,</span><span class="n">b2</span><span class="p">,</span><span class="n">b3</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># return y = b0 + b1*x + b2*x**2 + b3*x**3</span>
    <span class="n">polynomial</span><span class="o">=</span><span class="n">b0</span><span class="o">+</span><span class="n">b1</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="n">b2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">b3</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">3</span>  
    <span class="k">return</span><span class="p">(</span><span class="n">polynomial</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we have a data model, that returns speed given time according to a polynomial equation.</p>
<p>Lets dcompare some guesses at values for <span class="math notranslate nohighlight">\(\beta_0,\beta_2,\beta_2,\beta_3\)</span></p>
<p>Parameter set #1</p>
<blockquote>
<div><ul class="simple">
<li><p>b0 = 0</p></li>
<li><p>b1 = 6</p></li>
<li><p>b2 = 0.12</p></li>
<li><p>b3 = 0</p></li>
</ul>
</div></blockquote>
<p>Parameter set #2</p>
<blockquote>
<div><ul class="simple">
<li><p>b0 = 0</p></li>
<li><p>b1 = 1.3</p></li>
<li><p>b2 = 0.75</p></li>
<li><p>b3 = 0.05</p></li>
</ul>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># prompt for inputs of b0,b1,b2,b3</span>
<span class="c1"># do some trial and error 0,1.3,0.75,0.05</span>
<span class="c1">#intercept=float(input(&#39;Enter b0 value&#39;))</span>
<span class="c1">#linear=float(input(&#39;Enter b1 value&#39;))</span>
<span class="c1">#quadratic=float(input(&#39;Enter b2 value&#39;))</span>
<span class="c1">#cubic=float(input(&#39;Enter b3 value &#39;))</span>
<span class="n">intercept</span><span class="o">=</span><span class="mi">0</span>
<span class="n">linear</span><span class="o">=</span><span class="mi">6</span>
<span class="n">quadratic</span><span class="o">=</span><span class="mf">0.12</span>
<span class="n">cubic</span><span class="o">=</span><span class="mi">0</span>
<span class="c1"># build a data model</span>
<span class="n">modelSpeed</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)):</span>
    <span class="n">modelSpeed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polynomial</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="n">linear</span><span class="p">,</span><span class="n">quadratic</span><span class="p">,</span><span class="n">cubic</span><span class="p">,</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="c1"># Plotting results</span>
<span class="n">make2plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">speed</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">modelSpeed</span><span class="p">,</span><span class="s1">&#39;time (sec.)&#39;</span><span class="p">,</span><span class="s1">&#39;speed (m/s)&#39;</span><span class="p">,</span><span class="s1">&#39;Plot of model and observations using parameter set #1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson16_14_0.png" src="../../_images/lesson16_14_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># prompt for inputs of b0,b1,b2,b3</span>
<span class="c1"># do some trial and error 0,1.3,0.75,0.05</span>
<span class="c1">#intercept=float(input(&#39;Enter b0 value&#39;))</span>
<span class="c1">#linear=float(input(&#39;Enter b1 value&#39;))</span>
<span class="c1">#quadratic=float(input(&#39;Enter b2 value&#39;))</span>
<span class="c1">#cubic=float(input(&#39;Enter b3 value &#39;))</span>
<span class="n">intercept</span><span class="o">=</span><span class="mi">0</span>
<span class="n">linear</span><span class="o">=</span><span class="mf">1.3</span>
<span class="n">quadratic</span><span class="o">=</span><span class="mf">0.75</span>
<span class="n">cubic</span><span class="o">=</span><span class="mf">0.05</span>
<span class="c1"># build a data model</span>
<span class="n">modelSpeed</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)):</span>
    <span class="n">modelSpeed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polynomial</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="n">linear</span><span class="p">,</span><span class="n">quadratic</span><span class="p">,</span><span class="n">cubic</span><span class="p">,</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="c1"># Plotting results</span>
<span class="n">make2plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">speed</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">modelSpeed</span><span class="p">,</span><span class="s1">&#39;time (sec.)&#39;</span><span class="p">,</span><span class="s1">&#39;speed (m/s)&#39;</span><span class="p">,</span><span class="s1">&#39;Plot of model and observations using parameter set #2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson16_15_0.png" src="../../_images/lesson16_15_0.png" />
</div>
</div>
<p>Now assess the model; which one seems to explain the observations better?  That’s really the gist of exploratory data analysis.</p>
<p>The last plot looks kind of decent, how could we “measure” the model’s prediction value?</p>
<p>We can compute the difference between the observations and the model, add them all up and see how close to perfect we get.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prediction Error Function</span>
<span class="k">def</span> <span class="nf">pred_err</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span><span class="n">list2</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">list2</span><span class="p">):</span>
        <span class="n">pe</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list to store prediction errors</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list1</span><span class="p">)):</span>
            <span class="n">pe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">list2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">return</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">pe</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;incompatible lists, check your data&#39;</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="s1">&#39;false&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">pred_err</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span><span class="n">modelSpeed</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.881784197001252e-15
</pre></div>
</div>
</div>
</div>
<p>Seems pretty great, except maybe the positive and negative errors are cancelling each outer leading us to falsely believe our model is awesome.  A more strict error would be to consider absolute values as in:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prediction Error Function</span>
<span class="k">def</span> <span class="nf">abs_err</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span><span class="n">list2</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">list2</span><span class="p">):</span>
        <span class="n">pe</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list to store prediction errors</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list1</span><span class="p">)):</span>
            <span class="n">pe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">list1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">list2</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
        <span class="k">return</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">pe</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;incompatible lists, check your data&#39;</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="s1">&#39;false&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">abs_err</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span><span class="n">modelSpeed</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3.800000000000006
</pre></div>
</div>
</div>
</div>
<p>Or the commonly used sum of squared errors</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prediction Error Function</span>
<span class="k">def</span> <span class="nf">ssq_err</span><span class="p">(</span><span class="n">list1</span><span class="p">,</span><span class="n">list2</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list1</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">list2</span><span class="p">):</span>
        <span class="n">pe</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list to store prediction errors</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list1</span><span class="p">)):</span>
            <span class="n">pe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">pow</span><span class="p">((</span><span class="n">list1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">list2</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">return</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">pe</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;incompatible lists, check your data&#39;</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="s1">&#39;false&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ssq_err</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span><span class="n">modelSpeed</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.219999999999999
</pre></div>
</div>
</div>
</div>
<p>It becomes apparent quickly that it is a hastle to keep going back, so lets wrap things in a while loop so we can keep track of our trials, and make  our tool interactive.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will need to copy-paste into a notebook to run the script below - be sure to include the functions above</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">quit</span><span class="o">=</span><span class="kc">True</span>
<span class="c1"># put some default values</span>
<span class="n">intercept</span><span class="o">=</span><span class="mi">0</span>
<span class="n">linear</span><span class="o">=</span><span class="mi">0</span>
<span class="n">quadratic</span><span class="o">=</span><span class="mi">0</span>
<span class="n">cubic</span><span class="o">=</span><span class="mi">0</span>
<span class="c1"># here is the control loop</span>
<span class="k">while</span> <span class="n">quit</span><span class="p">:</span>
<span class="c1"># prompt for inputs of b0,b1,b2,b3</span>
<span class="c1"># do some trial and error 0,1.3,0.75,0.05</span>
    <span class="n">intercept</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter b0 value, current value = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">intercept</span><span class="p">)))</span>
    <span class="n">linear</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter b1 value, current value = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">linear</span><span class="p">)))</span>
    <span class="n">quadratic</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter b2 value, current value = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">quadratic</span><span class="p">)))</span>
    <span class="n">cubic</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter b3 value, current value = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">cubic</span><span class="p">)))</span>
<span class="c1"># build a data model</span>
    <span class="n">modelSpeed</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)):</span>
        <span class="n">modelSpeed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polynomial</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="n">linear</span><span class="p">,</span><span class="n">quadratic</span><span class="p">,</span><span class="n">cubic</span><span class="p">,</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="c1"># Plotting results</span>
    <span class="n">make2plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">speed</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">modelSpeed</span><span class="p">,</span><span class="s1">&#39;time (sec.)&#39;</span><span class="p">,</span><span class="s1">&#39;speed (m/s)&#39;</span><span class="p">,</span><span class="s1">&#39;Plot of model and observations&#39;</span><span class="p">)</span>
    <span class="c1"># Squared Prediction Error</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Current squared error = &#39;</span><span class="p">,</span><span class="n">ssq_err</span><span class="p">(</span><span class="n">speed</span><span class="p">,</span><span class="n">modelSpeed</span><span class="p">))</span>
    <span class="n">stop</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;do you want to stop? y or n&#39;</span><span class="p">)</span> <span class="c1"># here is how we stop</span>
    <span class="k">if</span> <span class="n">stop</span> <span class="o">==</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span>
        <span class="n">quit</span><span class="o">=</span><span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">continue</span> <span class="c1"># keep going!</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">intercept</span><span class="o">=</span><span class="mi">0</span>
<span class="n">linear</span><span class="o">=</span><span class="mf">1.3</span>
<span class="n">quadratic</span><span class="o">=</span><span class="mf">0.75</span>
<span class="n">cubic</span><span class="o">=</span><span class="mf">0.05</span>
<span class="c1"># build a data model</span>
<span class="n">modelSpeed</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)):</span>
    <span class="n">modelSpeed</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polynomial</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="n">linear</span><span class="p">,</span><span class="n">quadratic</span><span class="p">,</span><span class="n">cubic</span><span class="p">,</span><span class="n">time</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="c1"># Plotting results</span>
<span class="n">make2plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">speed</span><span class="p">,</span><span class="n">time</span><span class="p">,</span><span class="n">modelSpeed</span><span class="p">,</span><span class="s1">&#39;time (sec.)&#39;</span><span class="p">,</span><span class="s1">&#39;speed (m/s)&#39;</span><span class="p">,</span><span class="s1">&#39;Plot of model and observations using parameter set #2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson16_24_0.png" src="../../_images/lesson16_24_0.png" />
</div>
</div>
<p>Now lets predict a value within our observations, say the speed at 4.5 seconds.  Looking at the graph it looks like about 25 m/sec.  But we have the data model, so just use it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#mytime=float(input(&#39;enter an elapsed time&#39;))</span>
<span class="n">mytime</span> <span class="o">=</span> <span class="mf">4.5</span>
<span class="n">myspeed</span> <span class="o">=</span> <span class="n">polynomial</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="n">linear</span><span class="p">,</span><span class="n">quadratic</span><span class="p">,</span><span class="n">cubic</span><span class="p">,</span><span class="n">mytime</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The estimated speed at t =&#39;</span><span class="p">,</span><span class="n">mytime</span><span class="p">,</span><span class="s1">&#39;is&#39;</span><span class="p">,</span><span class="n">myspeed</span><span class="p">,</span><span class="s1">&#39;meters per secund&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The estimated speed at t = 4.5 is 25.59375 meters per secund
</pre></div>
</div>
</div>
</div>
<p>Now lets predict a value beyond the observations, say the speed at 7 seconds.  Looking at the graph the best we can say is if the curvature is extended the value is somewhere near 60 (surely bigger than 45).   But beyond that we know nothing.  The data model allows extrapolation simply because we have <strong>declared</strong> it the relationship that explains the observatons.  If the model were based on some physical, chemical, or biological process we might actually be comfortable making extrapolations; here we will just stipulate that 1 more second is close to the observations, so we will extrapolate; again using our data model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#mytime=float(input(&#39;enter an elapsed time&#39;))</span>
<span class="n">mytime</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">myspeed</span> <span class="o">=</span> <span class="n">polynomial</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="n">linear</span><span class="p">,</span><span class="n">quadratic</span><span class="p">,</span><span class="n">cubic</span><span class="p">,</span><span class="n">mytime</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The estimated speed at t =&#39;</span><span class="p">,</span><span class="n">mytime</span><span class="p">,</span><span class="s1">&#39;is&#39;</span><span class="p">,</span><span class="n">myspeed</span><span class="p">,</span><span class="s1">&#39;meters per secund&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The estimated speed at t = 7 is 63.0 meters per secund
</pre></div>
</div>
</div>
</div>
<p>Our next section will examine a type of data model useful for interpolating data that are known to be accurate (very small measurement error)</p>
<hr class="docutils" />
<div class="section" id="lagrangian-polynomial-data-model-for-interpolation">
<h3>Lagrangian Polynomial Data Model (for Interpolation)<a class="headerlink" href="#lagrangian-polynomial-data-model-for-interpolation" title="Permalink to this headline">¶</a></h3>
<p>The Starship rocket in the figure below sends a lot of telemetry data to both on-board and off-board (ground-based) control computers.</p>
<p><img alt="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b9/SpaceX_Starship_SN8_launch_as_viewed_from_South_Padre_Island.jpg/800px-SpaceX_Starship_SN8_launch_as_viewed_from_South_Padre_Island.jpg" src="../../_images/800px-SpaceX_Starship_SN8_launch_as_viewed_from_South_Padre_Island.png" /></p>
<p>Suppose telemetry is received every 1/10 of a second, providing the altitude (position) of the craft, something like the figure below.</p>
<p><img alt="" src="../../_images/altitude-time.png" /></p>
<p>How can one estimate the altitude at intermediate times (between the 1/10 of a second “true” values)?</p>
<p>The problem is a type of interpolation problem similar to calculating material properties from tables for intermediate values by assuming a straight line passed between the two values from the table. However it may not be appropriate to assume that the altitudes are linear with time.  The special challenge comes when we want to estimate intermediate values when there is a maximum or minimum in the tabular structure, and we will have to process many records for different cases.</p>
<p>The classical approach to such a problem is to fit a polynomial to the tabular results and interrogate the resulting polynomial to obtain estimates of the intermediate values.  This prediction engine (the polynomial) is required to return the exact value at a observation location (in our case a 1/10 second interval).  This requirement is quite distinct from other types of prediction engines we will study.</p>
</div>
<div class="section" id="lagrangian-interpolation">
<h3>Lagrangian Interpolation<a class="headerlink" href="#lagrangian-interpolation" title="Permalink to this headline">¶</a></h3>
<p>Polynomial interpolation is the method of determining a polynomial that fits a set of given points. There are several approaches to polynomial interpolation, of which one of the most well known is the Lagrangian method. The Lagrangian polynomial <a class="reference external" href="https://en.wikipedia.org/wiki/Lagrange_polynomial">https://en.wikipedia.org/wiki/Lagrange_polynomial</a> is the polynomial of order <span class="math notranslate nohighlight">\(n-1\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is he number of tabular data pairs we wish to interpolate.</p>
<p>Suppose we have a table of data (or telemetry sent back from our rocket), of <span class="math notranslate nohighlight">\(x-\)</span> and <span class="math notranslate nohighlight">\(f(x)\)</span>-values:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>$<span class="math notranslate nohighlight">\(x~\)</span>$</p></th>
<th class="text-align:left head"><p>$<span class="math notranslate nohighlight">\(~f(x)\)</span>$</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>$<span class="math notranslate nohighlight">\(x_1\)</span>$</p></td>
<td class="text-align:left"><p>$<span class="math notranslate nohighlight">\(f_1\)</span>$</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>$<span class="math notranslate nohighlight">\(x_2\)</span>$</p></td>
<td class="text-align:left"><p>$<span class="math notranslate nohighlight">\(f_2\)</span>$</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>$<span class="math notranslate nohighlight">\(x_3\)</span>$</p></td>
<td class="text-align:left"><p>$<span class="math notranslate nohighlight">\(f_3\)</span>$</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>$<span class="math notranslate nohighlight">\(x_4\)</span>$</p></td>
<td class="text-align:left"><p>$<span class="math notranslate nohighlight">\(f_4\)</span>$</p></td>
</tr>
</tbody>
</table>
<p>The highest order polynomial that can be passed through these four data pairs is a cubic.  A Lagrangian form for such a cubic is</p>
<div class="math notranslate nohighlight">
\[ P_3(x) = f(x_1)\frac{(x-x_2)(x-x_3)(x-x_4)}{(x_1-x_2)(x_1-x_3)(x_1-x_4)} + f(x_2)\frac{(x-x_1)(x-x_3)(x-x_4)}{(x_2-x_1)(x_2-x_3)(x_2-x_4)} + f(x_3)\frac{(x-x_1)(x-x_2)(x-x_4)}{(x_3-x_1)(x_3-x_2)(x_3-x_4)} +f(x_4)\frac{(x-x_1)(x-x_2)(x-x_3)}{(x_4-x_1)(x_4-x_2)(x_4-x_3)} \]</div>
<p>Notice that it is constructed of four terms, each of which is a cubic in <span class="math notranslate nohighlight">\(x\)</span>; hence the sum is a cubic also.  The pattern of each term is to form the numerator as a product of differences of the form <span class="math notranslate nohighlight">\((x-x_i)\)</span>, omitting one <span class="math notranslate nohighlight">\(x_i\)</span> in each term, the ommitted term is used in the denominator as a replacement for <span class="math notranslate nohighlight">\(x\)</span> in each position in the numerator.  In each term, the difference factor is multiplied by the value <span class="math notranslate nohighlight">\(f_i\)</span> corresponding to the <span class="math notranslate nohighlight">\(x_i\)</span> ommitted in the numerator. The Lagragian polynomial for other degrees of interpolating polynomials employs this same pattern of forming a sum of polynomials of the desired degree.</p>
<p>Of importance is that the polynomial is intended to be used for interpolation, that is the value we seek <span class="math notranslate nohighlight">\(P(x^*)\)</span> assumes we will supply <span class="math notranslate nohighlight">\(x^*\)</span> in the range <span class="math notranslate nohighlight">\([x_1 , x_4]\)</span>.  Going outside this range is called extrapolation, and interpolator-type prediction engines are the wromg tool!</p>
</div>
<div class="section" id="example-1">
<h3>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">¶</a></h3>
<p>Consider the three observations below, estimate (predict) the value for <span class="math notranslate nohighlight">\(f(2.3)\)</span>.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>$<span class="math notranslate nohighlight">\(x~\)</span>$</p></th>
<th class="text-align:left head"><p>$<span class="math notranslate nohighlight">\(~f(x)\)</span>$</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>1.1</p></td>
<td class="text-align:left"><p>10.6</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>1.7</p></td>
<td class="text-align:left"><p>15.2</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>3.0</p></td>
<td class="text-align:left"><p>20.3</p></td>
</tr>
</tbody>
</table>
<p>The Lagrangian form of the highest order of polynomial that can pass through the 3 data pairs is the quadratic:</p>
<div class="math notranslate nohighlight">
\[ P_2(x) = f(x_1)\frac{(x-x_2)(x-x_3)}{(x_1-x_2)(x_1-x_3)} + f(x_2)\frac{(x-x_1)(x-x_3)}{(x_2-x_1)(x_2-x_3)} + f(x_3)\frac{(x-x_1)(x-x_2)}{(x_3-x_1)(x_3-x_2)} \]</div>
<p>Once the denominators are completed, it is relatively straightforward to compute the estimate (prediction), in this case</p>
<div class="math notranslate nohighlight">
\[ P_2(x) = (10.6)\frac{(x-1.7)(x-3.0)}{(1.1-1.7)(1.1-3.0)} + (15.2)\frac{(x-1.1)(x-3.0)}{(1.7-1.1)(1.7-3.0)} + (20.3)\frac{(x-1.1)(x-1.7)}{(3.0-1.1)(3.0-1.7)} \]</div>
<p>At <span class="math notranslate nohighlight">\(x=2.3\)</span> the result is <span class="math notranslate nohighlight">\(P_2(2.3)=18.38\)</span>.</p>
<p>Naturally, we want to use Computational Thinking principles, to pattern match and generalize the arithmetic as below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lagint</span><span class="p">(</span><span class="n">xlist</span><span class="p">,</span><span class="n">ylist</span><span class="p">,</span><span class="n">xpred</span><span class="p">):</span>
    <span class="c1"># lagrangian interpolation of order len(xlist)-1 </span>
    <span class="c1"># </span>
    <span class="n">lagint</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># ypred is an accumulator, and will be output</span>
    <span class="n">norder</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xlist</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">norder</span><span class="p">):</span>
        <span class="n">term</span> <span class="o">=</span> <span class="n">ylist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="c1"># build up terms of polynomial</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">norder</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">j</span><span class="p">):</span>
                <span class="n">term</span> <span class="o">=</span> <span class="n">term</span> <span class="o">*</span> <span class="p">(</span><span class="n">xpred</span><span class="o">-</span><span class="n">xlist</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">xlist</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">xlist</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
<span class="c1">#            pass # may not need this expression</span>
        <span class="n">lagint</span> <span class="o">=</span> <span class="n">lagint</span> <span class="o">+</span> <span class="n">term</span>
<span class="c1">#    print(i,j) #debugging expression</span>
    <span class="k">return</span><span class="p">(</span><span class="n">lagint</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xtable</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1.7</span><span class="p">,</span><span class="mf">3.0</span><span class="p">]</span>
<span class="n">ytable</span> <span class="o">=</span> <span class="p">[</span><span class="mf">10.6</span><span class="p">,</span><span class="mf">15.2</span><span class="p">,</span><span class="mf">20.3</span><span class="p">]</span>

<span class="n">xwant</span> <span class="o">=</span> <span class="mf">2.3</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">lagint</span><span class="p">(</span><span class="n">xtable</span><span class="p">,</span><span class="n">ytable</span><span class="p">,</span><span class="n">xwant</span><span class="p">),</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>18.38
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="example-2">
<h3>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">¶</a></h3>
<p>This example is copied from <a class="reference external" href="https://rstudio-pubs-static.s3.amazonaws.com/286315_f00cf07beb3945d2a0260d6eaecb5d36.html">https://rstudio-pubs-static.s3.amazonaws.com/286315_f00cf07beb3945d2a0260d6eaecb5d36.html</a></p>
<p>In the original source the author plots the resulting function, we can do the same here.  First the observation set:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>$<span class="math notranslate nohighlight">\(x~\)</span>$</p></th>
<th class="text-align:left head"><p>$<span class="math notranslate nohighlight">\(~f(x)\)</span>$</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>0</p></td>
<td class="text-align:left"><p>7</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>2</p></td>
<td class="text-align:left"><p>11</p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>3</p></td>
<td class="text-align:left"><p>28</p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>4</p></td>
<td class="text-align:left"><p>63</p></td>
</tr>
</tbody>
</table>
<p>Next we will plot the interpolating polynomial from <span class="math notranslate nohighlight">\(x=0\)</span> to <span class="math notranslate nohighlight">\(x=4\)</span> in steps of 0.1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xtable</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1.3</span><span class="p">]</span>
<span class="n">ytable</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.003</span><span class="p">,</span><span class="mf">0.067</span><span class="p">,</span><span class="mf">0.148</span><span class="p">,</span><span class="mf">0.248</span><span class="p">,</span><span class="mf">0.370</span><span class="p">,</span><span class="mf">0.518</span><span class="p">,</span><span class="mf">0.697</span><span class="p">]</span>
<span class="n">xwant</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lagint</span><span class="p">(</span><span class="n">xtable</span><span class="p">,</span><span class="n">ytable</span><span class="p">,</span><span class="n">xwant</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.067
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Observations</span>
<span class="n">xtable</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">ytable</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">63</span><span class="p">]</span>
<span class="c1">#</span>
<span class="n">xpred</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list to store results for plotting</span>
<span class="n">ypred</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list to store results for plotting</span>
<span class="c1">#</span>
<span class="n">step_size</span> <span class="o">=</span> <span class="mf">0.10</span>  <span class="c1"># step size</span>
<span class="n">how_many</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">xtable</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">xtable</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">step_size</span><span class="p">)</span>
<span class="c1"># build the predictions</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">how_many</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> 
    <span class="n">xpred</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">step_size</span><span class="p">)</span>
    <span class="n">ypred</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lagint</span><span class="p">(</span><span class="n">xtable</span><span class="p">,</span><span class="n">ytable</span><span class="p">,</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">step_size</span><span class="p">))</span>
<span class="c1">#print(lagint(xtable,ytable,xwant))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="c1"># the python plotting library</span>
<span class="n">myfigure</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="c1"># generate a object from the figure class, set aspect ratio</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xtable</span><span class="p">,</span> <span class="n">ytable</span> <span class="p">,</span><span class="n">color</span> <span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="c1"># The observations as points</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpred</span><span class="p">,</span> <span class="n">ypred</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span> <span class="c1"># the polynomial</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Input Value&quot;</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Function Value&quot;</span><span class="p">)</span> 
<span class="n">mytitle</span> <span class="o">=</span> <span class="s2">&quot;Interpolating Polynomial Fit to Observations</span><span class="se">\n</span><span class="s2"> &quot;</span>
<span class="n">mytitle</span> <span class="o">+=</span> <span class="s2">&quot;Blue Markers are Observations &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="n">mytitle</span> <span class="o">+=</span> <span class="s2">&quot;Red Curve is Fitted Polynomial &quot;</span><span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">mytitle</span><span class="p">)</span> 
<span class="n">matplotlib</span><span class="o">.</span><span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson16_37_0.png" src="../../_images/lesson16_37_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xtable</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">ytable</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">63</span><span class="p">]</span>

<span class="n">ypred</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xtable</span><span class="p">)):</span> 
    <span class="n">ypred</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lagint</span><span class="p">(</span><span class="n">xtable</span><span class="p">,</span><span class="n">ytable</span><span class="p">,</span><span class="n">xtable</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Interpolation Error&#39;</span><span class="p">,</span><span class="n">ssq_err</span><span class="p">(</span><span class="n">ytable</span><span class="p">,</span><span class="n">ypred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Interpolation Error 0.0
</pre></div>
</div>
</div>
</div>
<p>Now to finish the story lets apply our generic polynomial model to the same data and see what we can learn</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># observations</span>
<span class="n">xtable</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">ytable</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">63</span><span class="p">]</span>
<span class="c1">#</span>
<span class="c1"># build a data model</span>
<span class="n">intercept</span><span class="o">=</span><span class="mi">7</span>
<span class="n">linear</span><span class="o">=</span><span class="mf">0.69</span>
<span class="n">quadratic</span><span class="o">=-</span><span class="mf">0.95</span>
<span class="n">cubic</span><span class="o">=</span><span class="mf">1.06</span>
<span class="c1">#</span>
<span class="n">xpred</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list to store results for plotting</span>
<span class="n">ypred</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># empty list to store results for plotting</span>
<span class="c1">#</span>
<span class="n">step_size</span> <span class="o">=</span> <span class="mf">0.10</span>  <span class="c1"># step size</span>
<span class="n">how_many</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">xtable</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">xtable</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">step_size</span><span class="p">)</span>
<span class="c1"># build the predictions</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">how_many</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span> 
    <span class="n">xpred</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">step_size</span><span class="p">)</span>
    <span class="n">ypred</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polynomial</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="n">linear</span><span class="p">,</span><span class="n">quadratic</span><span class="p">,</span><span class="n">cubic</span><span class="p">,</span><span class="n">xpred</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="n">make2plot</span><span class="p">(</span><span class="n">xtable</span><span class="p">,</span><span class="n">ytable</span><span class="p">,</span><span class="n">xpred</span><span class="p">,</span><span class="n">ypred</span><span class="p">,</span><span class="s1">&#39;Input Value&#39;</span><span class="p">,</span><span class="s1">&#39;Function Value&#39;</span><span class="p">,</span><span class="s1">&#39;Plot of model and observations&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/lesson16_40_0.png" src="../../_images/lesson16_40_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xtable</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">ytable</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">63</span><span class="p">]</span>

<span class="n">ypred</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xtable</span><span class="p">)):</span> 
    <span class="n">ypred</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">polynomial</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span><span class="n">linear</span><span class="p">,</span><span class="n">quadratic</span><span class="p">,</span><span class="n">cubic</span><span class="p">,</span><span class="n">xtable</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Interpolation Error&#39;</span><span class="p">,</span><span class="n">ssq_err</span><span class="p">(</span><span class="n">ytable</span><span class="p">,</span><span class="n">ypred</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Interpolation Error 5.9031999999999885
</pre></div>
</div>
</div>
</div>
<p>Unlike the Lagrangian interpolation, here we can extrapolate, simply by using the data model.</p>
<hr>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Grus, Joel (2015-04-14). Data Science from Scratch: First Principles with Python
(Kindle Locations 1190-1191). O’Reilly Media. Kindle Edition.</p></li>
<li><p>Call Expressions in “Adhikari, A. and DeNero, J. Computational and Inferential Thinking The Foundations of Data Science” <a class="reference external" href="https://www.inferentialthinking.com/chapters/03/3/Calls.html">https://www.inferentialthinking.com/chapters/03/3/Calls.html</a></p></li>
<li><p>Functions and Tables in “Adhikari, A. and DeNero, J. Computational and Inferential Thinking The Foundations of Data Science” <a class="reference external" href="https://www.inferentialthinking.com/chapters/08/Functions_and_Tables.html">https://www.inferentialthinking.com/chapters/08/Functions_and_Tables.html</a></p></li>
<li><p>Visualization in “Adhikari, A. and DeNero, J. Computational and Inferential Thinking The Foundations of Data Science” <a class="reference external" href="https://www.inferentialthinking.com/chapters/07/Visualization.html">https://www.inferentialthinking.com/chapters/07/Visualization.html</a></p></li>
<li><p>Documentation; The Python Standard Library; 9. Numeric and Mathematical Modules <a class="reference external" href="https://docs.python.org/2/library/math.html">https://docs.python.org/2/library/math.html</a></p></li>
<li><p><a class="reference external" href="https://matplotlib.org/gallery/lines_bars_and_markers/horizontal_barchart_distribution.html?highlight=horizontal%20bar%20chart">https://matplotlib.org/gallery/lines_bars_and_markers/horizontal_barchart_distribution.html?highlight=horizontal bar chart</a></p></li>
<li><p><a class="reference external" href="https://www.geeksforgeeks.org/bar-plot-in-matplotlib/">https://www.geeksforgeeks.org/bar-plot-in-matplotlib/</a></p></li>
</ol>
<hr>
</div>
<div class="section" id="laboratory-16">
<h2>Laboratory 16<a class="headerlink" href="#laboratory-16" title="Permalink to this headline">¶</a></h2>
<p><strong>Examine</strong> (click) Laboratory 15 as a webpage at <a class="reference external" href="http://54.243.252.9/engr-1330-webroot/8-Labs/Lab16/Lab16.html">Laboratory 16.html</a></p>
<p><strong>Download</strong> (right-click, save target as …) Laboratory 15 as a jupyterlab notebook from <a class="reference external" href="http://54.243.252.9/engr-1330-webroot/8-Labs/Lab16/Lab16.ipynb">Laboratory 16.ipynb</a></p>
<hr><hr>
</div>
<div class="section" id="exercise-set-16">
<h2>Exercise Set 16<a class="headerlink" href="#exercise-set-16" title="Permalink to this headline">¶</a></h2>
<p><strong>Examine</strong> (click) Exercise Set 15 as a webpage at <a class="reference external" href="http://54.243.252.9/engr-1330-webroot/8-Labs/Lab16/Lab16-TH.html">Exercise 16.html</a></p>
<p><strong>Download</strong> (right-click, save target as …) Exercise Set 15 as a jupyterlab notebook at  <a class="reference external" href="http://54.243.252.9/engr-1330-webroot/8-Labs/Lab16/Lab16-TH.ipynb">Exercise Set 16.ipynb</a></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./lessons/lesson16"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="../lesson15/lesson15.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">15: The <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> package</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="../lesson17.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Lesson 17: Matrix manipulation</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Theodore G. Cleveland and Farhang Forghanparast<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>